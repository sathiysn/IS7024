@page
@using Newtonsoft.Json
@model HealthWatch360.Pages.ReportsModel
@{
}

<div class="card bg-dark text-light mb-4">
    <div class="card-body">
        <h5 class="text-center">Nutrition Overview</h5>

        <input type="text" id="foodSearch" placeholder="Search for food..." oninput="searchFoods()" />
        <ul id="searchResults" style="list-style-type: none; padding: 0; margin: 0;"></ul>

        <script>
            // Assuming you load your JSON data into this variable
            const foundationFoods = @Html.Raw(JsonConvert.SerializeObject(Model.Root.FoundationFoods));

            function searchFoods() {
                const searchQuery = document.getElementById('foodSearch').value.toLowerCase();
                const resultsContainer = document.getElementById('searchResults');
                resultsContainer.innerHTML = '';

                if (searchQuery) {
                    const matchingFoods = foundationFoods.filter(food =>
                        food.description.toLowerCase().includes(searchQuery)
                    );

                    matchingFoods.forEach(food => {
                        const li = document.createElement('li');
                        li.textContent = food.description;
                        li.onclick = () => selectFood(food);
                        resultsContainer.appendChild(li);
                    });
                }
            }

            function selectFood(food) {
                document.getElementById('foodSearch').value = food.description;
                document.getElementById('searchResults').innerHTML = '';
                console.log(`Selected food: ${food.description}, ID: ${food.fdcId}`);
                // You could also store the selected food in a hidden input or submit it to your backend here
            }
        </script>


        <!-- Placeholder Pie Chart -->
        <div class="d-flex justify-content-center my-3">
            <div class="pie-chart"></div>
        </div>
        <small class="text-muted">Macronutrients and Micronutrients Balance</small>
    </div>
</div>